{% extends 'base.html' %}

{% block extra_head %}
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;500;700&display=swap" rel="stylesheet">
    {# Opcional: Fonte para estrelas (usaremos Unicode, mas √© bom ter uma fonte forte) #}
{% endblock %}

{% block content %}
<main class="form-container">
    <h2 class="form-title">üéâ Avalie a torcida do {{ time }}!</h2>

    <form method="post" class="form-card form-avaliacao">
        {% csrf_token %}

        <div class="form-group">
            <label class="form-label">Time em Campo:</label>
            <input type="text" value="{{ time }}" disabled class="form-input" style="background-color: #f0f0f0; font-weight: 500;">
            <input type="hidden" name="time" value="{{ time }}">
        </div>

        <div class="form-group">
            <label class="form-label label-rating">üî• Emo√ß√£o da Torcida:</label>
            <div class="star-rating-group" dir="rtl">
                {% for i in "54321" %}
                    <input type="radio" id="emocao_{{ i }}" name="emocao" value="{{ i }}" required />
                    <label for="emocao_{{ i }}" title="{{ i }} Estrelas"></label>
                {% endfor %}
            </div>
        </div>

        <div class="form-group">
            <label class="form-label label-rating">üì£ Presen√ßa e Barulho:</label>
            <div class="star-rating-group" dir="rtl">
                {% for i in "54321" %}
                    <input type="radio" id="presenca_{{ i }}" name="presenca" value="{{ i }}" required />
                    <label for="presenca_{{ i }}" title="{{ i }} Estrelas"></label>
                {% endfor %}
            </div>
        </div>

        <div class="form-group">
            <label for="comentario" class="form-label">‚úçÔ∏è Seu Coment√°rio:</label>
            <textarea id="comentario" name="comentario" rows="4" placeholder="Descreva o espet√°culo nas arquibancadas! Fizeram a diferen√ßa?" class="form-input"></textarea>
        </div>

        <div class="form-buttons">
            <button type="submit" class="btn-submit">Enviar Review</button>
            <a href="{% url 'core:lista_partidas' %}" class="btn-cancel">Cancelar Avalia√ß√£o</a>
        </div>
    </form>
</main>

<style>
    /* --- Vari√°veis de Estilo (Consistente com o design de refer√™ncia) --- */
    :root {
        --card-bg: #ffffff;
        --text-primary: #1d2d35;
        --button-green: #28a745; 
        --button-green-hover: #218838;
        --button-cancel: #657786;
        --button-cancel-hover: #4e5d6a;
        --border-color: #e1e8ed;
        --border-focus-color: #00adb5;
        --shadow-color: rgba(0, 0, 0, 0.08);
        --star-color: gold; /* Cor das estrelas preenchidas */
    }

    /* --- Container Principal e Card --- */
    .form-container { max-width: 700px; margin: 2rem auto; padding: 1rem; font-family: 'Poppins', sans-serif; }
    .form-title { text-align: center; color: var(--text-primary); margin-bottom: 2rem; font-size: 2.25rem; }
    .form-card { background-color: var(--card-bg); border-radius: 12px; padding: 2rem; box-shadow: 0 4px 15px var(--shadow-color); border: 1px solid var(--border-color); display: flex; flex-direction: column; gap: 1.5rem; }
    
    /* Grupos e Labels */
    .form-group { display: flex; flex-direction: column; gap: 0.5rem; }
    .form-label { font-weight: 500; color: var(--text-primary); font-size: 0.95rem; }

    /* Inputs Padr√£o e Textarea */
    .form-input { 
        width: 100%; padding: 0.8rem 1rem; border: 1px solid var(--border-color); 
        border-radius: 8px; font-family: 'Poppins', sans-serif; font-size: 1rem; 
        color: var(--text-primary); background-color: #fdfdfd; box-sizing: border-box; 
        transition: border-color 0.3s ease, box-shadow 0.3s ease;
    }
    .form-input:focus { outline: none; border-color: var(--border-focus-color); box-shadow: 0 0 0 3px rgba(0, 173, 181, 0.15); }

    /* --- ESTILOS DO SISTEMA DE ESTRELAS --- */
    .label-rating {
        margin-bottom: 0.5rem; /* Ajusta o espa√ßamento acima das estrelas */
    }

    .star-rating-group {
        /* Configura o container para exibir os radio buttons na ordem reversa, 
           o que √© crucial para a t√©cnica CSS do seletor ~ (irm√£o geral) */
        display: flex;
        unicode-bidi: bidi-override;
        direction: rtl; /* For√ßa a renderiza√ß√£o da direita para a esquerda */
        justify-content: flex-end;
    }

    .star-rating-group > input {
        /* Esconde os radio buttons nativos, mantendo a funcionalidade */
        display: none;
    }

    .star-rating-group > label {
        /* Estiliza os labels para aparecerem como estrelas */
        display: inline-block;
        padding: 0 4px; /* Espa√ßamento entre as estrelas */
        font-size: 2rem; /* Tamanho das estrelas */
        color: #ccc; /* Cor das estrelas vazias (cinza claro) */
        cursor: pointer;
        transition: color 0.3s;
    }

    /* Desenha a estrela (usando o caractere Unicode) */
    .star-rating-group > label:before {
        content: "\2605"; /* Unicode da estrela preenchida */
    }

    /* 1. Efeito de Hover: Preenche a estrela atual e todas as anteriores */
    .star-rating-group > label:hover,
    .star-rating-group > label:hover ~ label {
        color: var(--star-color);
    }

    /* 2. Efeito de Click/Checked: Preenche a estrela selecionada e todas as anteriores */
    .star-rating-group > input:checked ~ label {
        color: var(--star-color);
    }

    /* 3. Manter Hover ap√≥s Sele√ß√£o (Resetar o Hover): Garante que, ao passar o mouse, 
       o estado checked n√£o seja sobreposto de forma indesejada */
    .star-rating-group:not(:hover) > input:checked ~ label {
        color: var(--star-color);
    }

    /* --- Estilos dos Bot√µes (Mantidos e Refor√ßados) --- */
    .form-buttons { display: flex; gap: 10px; margin-top: 1rem; }

    .btn-submit {
        background-color: var(--button-green); color: white; border: none; padding: 0.9rem 1.5rem;
        border-radius: 8px; cursor: pointer; font-family: 'Poppins', sans-serif; font-weight: 500;
        font-size: 1rem; flex-grow: 1; text-align: center; text-decoration: none; transition: all 0.3s ease;
    }
    .btn-submit:hover { background-color: var(--button-green-hover); transform: translateY(-2px); box-shadow: 0 4px 10px rgba(40, 167, 69, 0.3); }

    .btn-cancel {
        background-color: var(--button-cancel); color: white; padding: 0.9rem 1.5rem; border-radius: 8px;
        text-decoration: none; cursor: pointer; font-family: 'Poppins', sans-serif; font-weight: 500;
        font-size: 1rem; flex-grow: 1; text-align: center; transition: background-color 0.3s ease;
    }
    .btn-cancel:hover { background-color: var(--button-cancel-hover); }
</style>
{% endblock %}